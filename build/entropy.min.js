/**
* Entropy 0.2.0 - framework for making games and not only games in entity system manner - build: 2014-12-12
*
* @author       Tymoteusz Dzienniak <tymoteusz.dzienniak@outlook.com>
* @license      {@link https://github.com/RainPhilosopher/Entropy/blob/master/LICENSE|MIT License}
*/

!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.Entropy=a()}}(function(){var a;return function b(a,c,d){function e(g,h){if(!c[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,b,a,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c,d,e=[].slice;d=function(){function a(a){this.prev=null,this.next=null,this.data=null!=a?a:null}return a}(),c=function(){function a(){this.head=this.tail=null,this._current=this.head,this._pool=null}return a.prototype._getNewNode=function(a){var b;return null!=this._pool?(b=this._pool,this._pool=b.next,b.next=b.prev=null,b.data=a,null!=this._pool&&(this._pool.prev=null),b):new d(a)},a.prototype.append=function(a){var b;if(null!=a)return b=this._getNewNode(a),null==this.head?(this.tail=this.head=b,this):(this.tail.next=b,b.prev=this.tail,this.tail=b,this)},a.prototype.prepend=function(a){var b;if(null!=a)return b=this._getNewNode(a),null==this.head?(this.tail=this.head=b,this):(this.head.prev=b,b.next=this.head,this.head=b,this)},a.prototype.join=function(b,c){return null==c&&(c=!1),!b instanceof a?(console.warn("DoublyLinkedList.join argument must be type of DoublyLinkedList"),this):null==b.head?this:null==this.head?(this.head=b.head,this.tail=b.tail,this):(c?(b.tail.next=this.head,this.head.prev=b.tail,this.head=b.head,b.tail=this.tail):(b.head.prev=this.tail,this.tail.next=b.head,this.tail=b.tail,b.head=this.head),this)},a.prototype.remove=function(a,b){var c,d,e,f,g,h;if(null==b&&(b=!1),b){for(this.reset();c=this.next();)if(a===c.data){d=c;break}}else d=a;return null!=d&&(null==d.next&&null==d.prev?this.head=this.tail=null:d===this.head?(null!=(e=d.next)&&(e.prev=null),this.head=d.next):d===this.tail?(null!=(f=d.prev)&&(f.next=null),this.tail=d.prev):(null!=(g=d.next)&&(g.prev=d.prev),null!=(h=d.prev)&&(h.next=d.next))),this},a.prototype.pop=function(){},a.prototype.shift=function(){},a.prototype.push=function(a){return this.append(a)},a.prototype.unshift=function(a){return this.prepend(a)},a.prototype.one=function(){var a;return null!=(a=this.head)?a.data:void 0},a.prototype.begin=function(){return this._current=this.head,this},a.prototype.end=function(){return this._current=this.tail,this},a.prototype.next=function(){var a,b;return a=this._current,this._current=null!=(b=this._current)?b.next:void 0,a},a.prototype.prev=function(){var a,b;return a=this._current,this._current=null!=(b=this._current)?b.prev:void 0,a},a.prototype.current=function(){return this._current},a.prototype.iterate=function(){var a,b,c,d,f;for(c=arguments[0],b=arguments[1],a=3<=arguments.length?e.call(arguments,2):[],this.reset();d=this.next();)c.apply(b,[d,d.data,null!=(f=d.data)?f.components:void 0].concat(a));return this},a.prototype.reset=function(a){return null==a&&(a=!1),this._current=a?this.tail:this.head,this},a.prototype.clear=function(){return null!=this.tail&&(this.tail.next=this._pool,this._pool=this.head),this.head=this.tail=null,this._current=null,this},a}(),b.exports=c},{}],2:[function(a,b){var c,d,e=[].slice;c=function(){function a(a,b){this.next=null,this.priority=b,this.data=null!=a?a:null}return a}(),d=function(){function a(){this.head=this.tail=null,this._current=this.head}return a.prototype.insert=function(a,b){var d,e;if(e=new c(a,b),null==this.head)return null==e.priority&&(e.priority=0),this.head=this.tail=e,this;if(null==e.priority&&(e.priority=this.tail.priority),null==this.head.next)return this.head.priority<=e.priority?this.head.next=this.tail=e:(e.next=this.tail=this.head,this.head=e),this;if(e.priority>=this.tail.priority)return this.tail=this.tail.next=e,this;if(e.priority<this.head.priority)return e.next=this.head,this.head=e,this;for(d=this.head;null!=d.next;){if(d.next.priority>e.priority){e.next=d.next,d.next=e;break}d=d.next}return this},a.prototype.remove=function(a,b){var c,d;if(null==b&&(b=!1),null==this.head)return this;if(!b&&a===this.head||b&&a===this.head.data)return this.head===this.tail?this.clear():this.head=this.head.next,this;for(this.reset();c=this.next();)if(!b&&a===c.next||b&&a===(null!=(d=c.next)?d.data:void 0))return c.next===this.tail?(c.next=null,this.tail=c):c.next=c.next.next,this;return this},a.prototype.begin=function(){return this._current=this.head,this},a.prototype.end=function(){return this._current=this.tail,this},a.prototype.next=function(){var a,b;return a=this._current,this._current=null!=(b=this._current)?b.next:void 0,a},a.prototype.current=function(){return this._current},a.prototype.iterate=function(){var a,b,c,d;for(c=arguments[0],b=arguments[1],a=3<=arguments.length?e.call(arguments,2):[],this.reset();d=this.next();)c.apply(b,[d,d.data].concat(a));return this},a.prototype.reset=function(a){return null==a&&(a=!1),this._current=a?this.tail:this.head,this},a.prototype.clear=function(){return this.head=this.tail=null,this._current=null,this},a}(),b.exports=d},{}],3:[function(a,b){var c;c=function(){function a(){this.size=0,this.pool={}}return a.prototype.push=function(a,b){return a in this.pool||(this.pool[a]=[]),this.size++,this.pool[a].push(b)},a.prototype.pop=function(a){return this.has(a)?(this.size--,this.pool[a].pop()):void 0},a.prototype.has=function(a){return a in this.pool&&this.pool[a].length>0},a.prototype.size=function(){return this.size},a}(),b.exports=c},{}],4:[function(a,b){var c,d,e;e=a("../utils/type"),c={debug:3,max_components_count:100,max_frame_time:20,default_time_factor:1,default_fps:60},d={},b.exports=function(a,b){return e.of.string(a)?null==b?a in d?d[a]:a in c?c[a]:null:d[a]=b:null}},{"../utils/type":19}],5:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o={}.hasOwnProperty,p=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},q=[].slice;n=a("../utils/type"),k=a("../debug/debug"),j=a("../config/config"),l=a("../utils/extend"),m=a("./register"),g=a("./event"),i=a("../collection/pool"),h=a("../collection/orderedlinkedlist"),d=a("../collection/doublylinkedlist"),f=a("./entity"),c=a("bitset.js").BitSet,e=function(a){function b(a){var e,f;for(this.game=a,b.__super__.constructor.call(this),this._greatestEntityId=0,this._entityIdsToReuse=[],this._entities=[],this._systems=new h,this._singletonSystemsPresentInEngine={},this._searchingBitSet=new c(j("max_components_count")),this._excludingBitSet=new c(j("max_components_count")),this._componetsPool=new i,this._entitiesPool=new i,this._families={NONE:new d},this._functionalFamiliesPool=[],this._usedFunctionalFamilies=[],e=f=0;20>=f;e=++f)this._functionalFamiliesPool.push(new d);this._entitiesToRemove=[],this._BLANK_FAMILY=new d,this._updating=!1,this._benchmarkSystem=!1,this._benchmarkOnce=!0,this.on("engine:updateFinished",this._removeMarkedEntities,this),this.on("engine:updateFinished",this._transferFunctionalFamilies,this),this._entitiesCount=0,m.setCannotModify()}return p(b,a),b.Component=m.registerComponent,b.System=m.registerSystem,b.Entity=m.registerEntity,b.prototype.canModify=function(){return m.canModify()},b.prototype.isUpdating=function(){return this._updating},b.prototype.generateEntityId=function(){var a;return a=this._entityIdsToReuse.pop(),null==a&&(a=this._greatestEntityId++),a},b.prototype.getNewComponent=function(a){var b;return this._componetsPool.has(a)?this._componetsPool.pop(a):(b=m.getComponentPattern(a),null!=b?{name:b.name,_pattern:b}:(k.warning('component "%s" does not exist',a),{}))},b.prototype.addComponentToPool=function(a,b){return this._componetsPool.push(a,b)},b.prototype.create=function(){var a,b,c;return c=arguments[0],a=2<=arguments.length?q.call(arguments,1):[],a.unshift(this.game),b=this._getNewEntity(c),b.getPattern().create.apply(b,a),this._addEntityToFamilies(b),this._addEntityToEngine(b),b},b.prototype._getNewEntity=function(a){var b;return this._entitiesPool.has(a)?(b=this._entitiesPool.pop(a),b.renovate()):b=new f(a,this),b},b.prototype._addEntityToFamilies=function(a){var b,c,e,f,g;for(b=a.getPattern()._families,f=0,g=b.length;g>f;f++)c=b[f],null==(e=this._families)[c]&&(e[c]=new d),this._families[c].append(a);return this},b.prototype._addEntityToEngine=function(a){return this._entities[a.getId()]=a,this._entitiesCount++,this},b.prototype.remove=function(){var a,b,c,d;return b=arguments[0],a=2<=arguments.length?q.call(arguments,1):[],c=b.getId(),null==this._entities[c]?this:(a.unshift(this.game),d=b.getPattern(),d.remove&&d.remove.apply(b,a),this._removeEntityFromFamilies(b),b.removeAllComponents(),this._entitiesPool.push(b.name,b),delete this._entities[c],this._entityIdsToReuse.push(c),this._entitiesCount--,this)},b.prototype.removeAllEntities=function(){var a,b,c,d;if(this._updating)k.warning("cannot remove entities during engine update");else for(d=this._entities,b=0,c=d.length;c>b;b++)a=d[b],this.remove(a);return this},b.prototype.markForRemoval=function(a){return this._entitiesToRemove.push(a),this},b.prototype._removeMarkedEntities=function(){var a,b,c,d;for(d=this._entitiesToRemove,b=0,c=d.length;c>b;b++)a=d[b],this.remove(a);return this._entitiesToRemove.length=0,this},b.prototype._removeEntityFromFamilies=function(a){var b,c,d,e,f;for(b=a.getPattern()._families,d=0,e=b.length;e>d;d++)c=b[d],null!=(f=this._families[c])&&f.remove(a,!0);return this},b.prototype.getEntity=function(a){var b;return null!=(b=this._entities[a])?b:null},b.prototype.getFamily=function(a){var b;return(null!=(b=this._families[a])?b:this._BLANK_FAMILY).reset()},b.prototype.getEntitiesByFamily=function(a){return this.getFamily(a)},b.prototype.getEntitiesWith=function(a,b){var c,d,e,f,g,h,i,j,k,l,o,p;if(null==b&&(b=!1),e=b?[]:this._getNewFunctionalFamily(),this._searchingBitSet.clear(),this._excludingBitSet.clear(),n.of.object(a)){if(n.of.array(a.without))for(l=a.without,f=0,i=l.length;i>f;f++)c=l[f],this._excludingBitSet.set(m.getComponentPattern(c)._bit);a=null!=(o=a["with"])?o:[]}for(g=0,j=a.length;j>g;g++)c=a[g],this._searchingBitSet.set(m.getComponentPattern(c)._bit);for(p=this._entities,h=0,k=p.length;k>h;h++)d=p[h],!n.of.undefined(d)&&this._searchingBitSet.subsetOf(d._bitset)&&this._excludingBitSet.and(d._bitset).isEmpty()&&e.push(d);return e.reset&&e.reset(),e},b.prototype.getEntitiesByName=function(){},b.prototype._getNewFunctionalFamily=function(){var a;return a=this._functionalFamiliesPool.pop(),null==a&&(a=new d,this._usedFunctionalFamilies.push(a)),a},b.prototype._transferFunctionalFamilies=function(){for(var a;a=this._usedFunctionalFamilies.pop();)this._functionalFamiliesPool.push(a.clear());return this},b.prototype.addSystem=function(){var a,b,c,d,e;return b=arguments[0],d=arguments[1],a=3<=arguments.length?q.call(arguments,2):[],b in this._singletonSystemsPresentInEngine?(k.warning("system %s is defined as singleton and is already present in engine"),this):(c=m.getSystemPattern(b),e={game:this.game,engine:this,priority:d},l(e,c),e.initialize&&e.initialize.apply(e,a),this._systems.insert(e,d),e.singleton&&(this._singletonSystemsPresentInEngine[b]=!0),this)},b.prototype.addSystems=function(){var a,b,c,d;for(b=1<=arguments.length?q.call(arguments,0):[],c=0,d=b.length;d>c;c++)a=b[c],this.addSystem.apply(this,a);return this},b.prototype.plug=function(){var a;return a=1<=arguments.length?q.call(arguments,0):[],this.addSystem.apply(this,a)},b.prototype.removeSystem=function(){var a,b;return b=arguments[0],a=2<=arguments.length?q.call(arguments,1):[],this.once("engine:updateFinished",function(c){return function(){return b.remove&&b.remove.apply(b,a),c._systems.remove(b,!0),delete c._singletonSystemsPresentInEngine[b.name]}}(this)),this},b.prototype.removeAllSystems=function(){var a,b,c;for(a=1<=arguments.length?q.call(arguments,0):[],this._systems.reset();b=this._systems.next();)c=b.data,c.remove&&c.remove.apply(c,a);return this._systems.clear(),this},b.prototype.isSystemActive=function(){},b.prototype.update=function(a){var b,c,d,e;for(b=a.delta,this.emit("engine:beforeUpdate",a),this._updating=!0,this._systems.reset();c=this._systems.next();)e=c.data,this._benchmarkSystem&&(d=performance.now()),e.update(b,a),this._benchmarkSystem&&k.log("%s took %f ms to update",e.name,performance.now()-d);return this._benchmarkOnce&&(this._benchmarkSystem=!1),this._updating=!1,this.emit("engine:afterUpdate",a),this.emit("engine:updateFinished")},b.prototype.clear=function(a){return a?(this.removeAllSystems(),this.removeAllEntities()):this.once("engine:updateFinished",function(a){return function(){return a.removeAllSystems(),a.removeAllEntities()}}(this)),this},b.prototype.benchmarkSystems=function(a){return null==a&&(a=!0),this._benchmarkSystem=!0,this._benchmarkOnce=a},b}(g),b.exports=e},{"../collection/doublylinkedlist":1,"../collection/orderedlinkedlist":2,"../collection/pool":3,"../config/config":4,"../debug/debug":13,"../utils/extend":17,"../utils/type":19,"./entity":6,"./event":7,"./register":10,"bitset.js":20}],6:[function(a,b){var c,d,e,f,g,h,i,j={}.hasOwnProperty,k=function(a,b){function c(){this.constructor=a}for(var d in b)j.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l=[].slice;f=a("../config/config"),i=a("../utils/type"),g=a("../debug/debug"),e=a("./event"),h=a("./register"),c=a("bitset.js").BitSet,d=function(a){function b(a,d){this.engine=d,b.__super__.constructor.call(this),this._id=this.engine.generateEntityId(),this._bitset=new c(f("max_components_count")),this._pattern=h.getEntityPattern(a),this._setDefaults(),this.name=a,this.components={},this.engine.on("engine:updateFinished",this._applyStateChanges,this)}return k(b,a),b.prototype.getId=function(){return this._id},b.prototype.getPattern=function(){return this._pattern},b.prototype.add=function(){var a,b,c,d,e;return d=arguments[0],a=2<=arguments.length?l.call(arguments,1):[],i.of.string(d)?(c=d.toLowerCase(),b=null!=(e=this.components[c])?e:this.engine.getNewComponent(c),b._pattern.initialize.apply(b,a),this.components[c]=b,this._bitset.set(b._pattern._bit),this):(g.warning("component name should be string"),this)},b.prototype.remove=function(a,b){var c,d,e;if(null==b&&(b=!1),!i.of.string(a))return g.warning("component name should be string"),this;if(e=a.toLowerCase(),d=this.components[e],null!=d){if(c=d._pattern._bit,0===this._bitset.get(c)&&!b)return this;b&&(this.engine.addComponentToPool(e,d),delete this.components[e]),this._bitset.clear(c)}return this},b.prototype.removeAllComponents=function(a){var b;if(null==a&&(a=!1),a){for(b in this.components)this.remove(b,!0);return this}return this._bitset.clear(),this},b.prototype.has=function(a){var b;return i.of.string(a)?1===this._bitset.get(null!=(b=this.components[a.toLowerCase()])?b._pattern._bit:void 0):!1},b.prototype.renovate=function(){return this._id=this.engine.generateEntityId(),this._setDefaults(),this},b.prototype._setDefaults=function(){return this._inFinalState=!1,this._remainingStateChanges=[],this._stateObject={},this._currentStates=[],this._stateChanges=[]},b.prototype.enter=function(){var a,b,c;return b=arguments[0],a=2<=arguments.length?l.call(arguments,1):[],this._inFinalState?(g.log("entity %s is in its final state",this.name),this):null==this._pattern.states||b in this._pattern.states?(c=this._pattern.states[b],c.excluding&&this._exitAllStates(),this._stateChanges.push({name:b,action:"enter",fn:c.enter,args:a}),this):(g.warning("there is no state %s for entity %s",b,this.name),this)},b.prototype.exit=function(){var a,b,c;return b=arguments[0],a=2<=arguments.length?l.call(arguments,1):[],this._inFinalState?(g.log("entity %s is in its final state",this.name),this):this["in"](b)?null==this._pattern.states||b in this._pattern.states?(c=this._pattern.states[b],this._stateChanges.push({name:b,action:"exit",fn:c.exit,args:a}),this):(g.warning("there is no state %s for entity %s",b,this.name),this):(g.warning("entity %s is not ins state %s - no exiting required",this.name,b),this)},b.prototype["in"]=function(){var a,b,c,d;if(b=1<=arguments.length?l.call(arguments,0):[],0===b.length)return!1;for(c=0,d=b.length;d>c;c++)if(a=b[c],-1===this._currentStates.indexOf(a))return!1;return!0},b.prototype._exitAllStates=function(){var a,b,c,d,e;for(d=this._currentStates,e=[],b=0,c=d.length;c>b;b++)a=d[b],e.push(this.exit(a));return e},b.prototype._applyStateChanges=function(){var a,b,c,d,e,f;if(!this._inFinalState){for(f=[];a=this._stateChanges.shift();)"enter"===a.action&&this["in"](a.name)||"exit"===a.action&&!this["in"](a.name)||(b=a.name,d=this._pattern.states[b],c=null!=(e=this._stateObject)[b]?e[b]:e[b]={},a.args.unshift(c),a.fn&&a.fn.apply(this,a.args),"enter"===a.action?this._currentStates.push(b):"exit"===a.action&&(this._currentStates.splice(this._currentStates.indexOf(b),1),delete this._stateObject[b]),f.push(d.final?this._inFinalState=!0:void 0));return f}},b}(e),b.exports=d},{"../config/config":4,"../debug/debug":13,"../utils/type":19,"./event":7,"./register":10,"bitset.js":20}],7:[function(a,b){var c,d,e=[].slice;d=a("../utils/type"),c=function(){function a(){this.events={}}return a.prototype.on=function(a,b,c,e){var f;return d.of.string(a||!d.of["function"](b))?(null==(f=this.events)[a]&&(f[a]=[]),void this.events[a].push({fn:b,binding:null!=c?c:null,once:null!=e?e:!1})):void 0},a.prototype.once=function(a,b,c){return this.on(a,b,c)},a.prototype.emit=function(){var a,b;return b=arguments[0],a=2<=arguments.length?e.call(arguments,1):[],b in this.events?void(this.events[b]=this.events[b].filter(function(b){return!b.fn.apply(b.binding,a)||!b.once})):void 0},a.prototype.trigger=function(){var a;return a=1<=arguments.length?e.call(arguments,0):[],this.emit.apply(this,a)},a.prototype.off=function(a,b){return d.of.string(a||!a in this.events)?void(this.events[a]=this.events[a].filter(function(a){return null!=b&&a.fn!==b})):void 0},a}(),b.exports=c},{"../utils/type":19}],8:[function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty,o=function(a,b){function c(){this.constructor=a}for(var d in b)n.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},p=[].slice;m=a("../utils/type"),e=a("./engine"),i=a("./input"),l=a("./ticker"),k=a("./state"),j=a("inverse"),f=a("./event"),g=0,d=1,c=2,h=function(a){function b(a){return b.__super__.constructor.call(this),this.input=new i(this),this.engine=new e(this),this.ticker=new l(this),this.state=k.State(this),this.container=new j,this.ticker.on("ticker:tick",this.engine.update,this.engine),this.engine.on("engine:updateFinished",this.input.clearKeyTimes,this.input),m.of.string(a)&&this.state.change(a),this}return o(b,a),b.State=k.register,b.prototype.start=function(){return this.emit("game:start",this.ticker.start())},b.prototype.pause=function(){return this.emit("game:pause",this.ticker.pause())},b.prototype.resume=function(){return this.emit("game:resume",this.ticker.resume())},b.prototype.stop=function(a){return a?(this.engine.once("engine:clear",function(a){return function(){return a.emit("game:stop",a.ticker.stop())}}(this)),this.engine.clear()):this.emit("game:stop",this.ticker.stop())},b.prototype.setRenderer=function(a){this.renderer=a},b.prototype.setStage=function(a){this.stage=a},b.prototype.changeState=function(){var a,b;return a=1<=arguments.length?p.call(arguments,0):[],(b=this.state).change.apply(b,a)},b}(f),b.exports=h},{"../utils/type":19,"./engine":5,"./event":7,"./input":9,"./state":11,"./ticker":12,inverse:21}],9:[function(a,b){(function(a){var c,d;d={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE_BREAK:19,"CAPS_LOCK ":20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,LEFT_WINDOW_KEY:91,RIGHT_WINDOW_KEY:92,SELECT_KEY:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL_POINT:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMI_COLON:186,EQUAL_SIGN:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222},c=function(){function b(){this._pressedKeys=[],this._pressedKeysTime=[],this._oncePressedKeys=[],this._mousePosition={x:0,y:0},a.addEventListener("keydown",function(a){return function(b){var c;c=b.keyCode,a._pressedKeys[c]=!0,a._pressedKeysTime[c]||(a._pressedKeysTime[c]=performance.now())}}(this)),a.addEventListener("keyup",function(a){return function(b){var c;c=b.keyCode,a._pressedKeys[c]=!1,null!=a._pressedKeysTime[c]&&null==a._oncePressedKeys[c]&&(a._pressedKeysTime[c]=performance.now()-a._pressedKeysTime[c],a._oncePressedKeys[c]=!0)}}(this))}return b.prototype.isPressed=function(a){return this._pressedKeys[d[a]]},b.prototype.getPressedKeys=function(){var a,b,c,e,f;for(b={},f=Object.keys(d),c=0,e=f.length;e>c;c++)a=f[c],b[a]=this._pressedKeys[d[a]];return b},b.prototype.getKeysPressedLessThan=function(a){var b,c,e,f,g,h;for(e={},h=Object.keys(d),f=0,g=h.length;g>f;f++)c=h[f],b=d[c],this._pressedKeysTime[b]<a&&this._oncePressedKeys[b]&&(e[c]=!0);return e},b.prototype.getKeysPressedMoreThan=function(a){var b,c,e,f,g,h;for(e={},h=Object.keys(d),f=0,g=h.length;g>f;f++)c=h[f],b=d[c],this._pressedKeysTime[b]>a&&this._oncePressedKeys[b]&&(e[c]=!0);return e},b.prototype.setMouseStagePosition=function(a){return this._mousePosition=a},b.prototype.getMouseStagePosition=function(){return this._mousePosition},b.prototype.clearKeyTimes=function(){return this._pressedKeysTime=[],this._oncePressedKeys=[]},b}(),b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],10:[function(a,b){var c,d,e,f,g,h,i,j;j=a("../utils/type"),f=a("../debug/debug"),e=a("../config/config"),c=!0,d={},i={},g={},h=0,b.exports={registerComponent:function(a){return c?j.of.object(a)?"name"in a&&"initialize"in a?a.name in d?void f.error("you can't define same component twice"):(a._bit=h++,d[a.name.toLowerCase()]=a):void f.error('you must define both "name" and "initialize" of component pattern'):void f.error("component pattern must be an object"):void f.error("you can't define new component during system work")},registerSystem:function(a){return c?j.of.object(a)?"name"in a&&"update"in a?a.name in i?void f.error("you can't define same system twice"):i[a.name]=a:void f.error('you must define both "name" and "update" of system pattern'):void f.error("system pattern must be an object"):void f.error("you can't define new system during system work")},registerEntity:function(a){return c?j.of.object(a)?"name"in a&&"create"in a?a.name in g?void f.error("you can't define same entity twice"):((null==a.family||""===a.family)&&(a.family="NONE"),a._families=a.family.split("|"),g[a.name]=a):void f.error('you must define both "name" and "create" of entity pattern'):void f.error("entity pattern must be an object"):void f.error("you can't define new system during system work")},getComponentPattern:function(a){return d[a.toLowerCase()]},getSystemPattern:function(a){return i[a]},getEntityPattern:function(a){return g[a]},canModify:function(){return c},setCannotModify:function(){return c=!1}}},{"../config/config":4,"../debug/debug":13,"../utils/type":19}],11:[function(a,b,c){var d,e,f,g=[].slice;f=a("../utils/type"),d=a("../debug/debug"),e={},c.State=function(a){var b,c,h,i,j,k,l,m,n,o,p;return l=[],b={transitions:{}},p=!1,o=function(){var a,b,c,d;return d=l.shift(),null==d?void(p=!1):(p=!0,c=d.fn,b=d.binding||null,a=d.args||[],a.push(k),c.apply(b,a))},k=function(){return o()},m=function(a,c){return b=a,c()},n=function(a,b){return a._initialized=!0,b()},j=function(b,c){return f.of["function"](b.initialize)?b.initialize.apply(b,[a,c]):c()},h=function(b,c){return f.of["function"](b.onEnter)?b.onEnter.apply(b,[a,c]):c()},i=function(c){return f.of["function"](b.onExit)?b.onExit.apply(b,[a,c]):c()},c=function(){var c,d,e,f,h;return f=arguments[0],e=arguments[1],c=3<=arguments.length?g.call(arguments,2):[],f in b.transitions?(h=b.transitions[f],b[h].apply(b,[a,e].concat(c))):(d=c.pop())()},{change:function(){var a,b,k;return b=arguments[0],a=2<=arguments.length?g.call(arguments,1):[],f.of.string(b)&&b in e?(k=e[b],l.push({fn:i}),k._initialized||(l.push({fn:j,args:[k]}),l.push({fn:n,args:[k]})),l.push({fn:c,args:[b,k].concat(a)}),l.push({fn:h,args:[k]}),l.push({fn:m,args:[k]}),p?void 0:o()):void d.error('state "'+b+'" does not exist - change will not occur')},current:function(){return b.name},isIn:function(a){return a===b.name}}},c.register=function(a){return f.of.object(a)?("transitions"in a||(a.transitions={}),a._initialized=!1,e[a.name]=a,this):(d.error("registered state must be an object"),this)}},{"../debug/debug":13,"../utils/type":19}],12:[function(a,b){(function(c){var d,e,f,g,h={}.hasOwnProperty,i=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a};f=a("../config/config"),g=c.requestAnimationFrame,d=a("./event"),e=function(a){function b(){b.__super__.constructor.call(this),this.FPS=f("default_fps"),this.MAX_FRAME_TIME=f("max_frame_time"),this.TIME_FACTOR=f("default_time_factor"),this._paused=!1,this._running=!1,this._ticks=0,this._lastTime=0,this._currentFPS=this.FPS,this._rafId=-1,this._desiredDelta=1e3/this.FPS,this._deltaSum=0}return i(b,a),b.prototype.setFPS=function(a){return this.FPS=a||this.FPS,this._desiredDelta=1e3/this.FPS},b.prototype.getCurrentFPS=function(){return Math.round(this._currentFPS)},b.prototype.setTimeFactor=function(a){return this.TIME_FACTOR=a||this.TIME_FACTOR},b.prototype.getTicks=function(){return this._ticks},b.prototype.pause=function(){return this._running?(this._paused=!0,!0):!1},b.prototype.resume=function(){return this._running?(this._paused=!1,!0):!1},b.prototype.start=function(){return this._paused&&this.resume(),this._running?!1:(this._rafId=g(this._tick.bind(this)),this.emit("ticker:start"),this._running=!0,!0)},b.prototype.stop=function(){return-1!==this._rafId?(c.cancelAnimationFrame(this._rafId),this._running=this._paused=!1,this.emit("ticker:stop"),!0):!1},b.prototype.toggle=function(){return this._running?(this._paused=!this._paused,!0):!1},b.prototype.isPaused=function(){return this._paused},b.prototype.isRunning=function(){return this._running&&!this._paused},b.prototype._tick=function(a){var b,c;if(null==a&&(a=performance.now()),b=a-this._lastTime,this._lastTime=a,this._rafId=g(this._tick.bind(this)),this.emit("ticker:raf",b),!this._paused){if(60!==this.FPS){if(this._deltaSum+=b,this._deltaSum<this._desiredDelta)return;b=this._deltaSum,this._deltaSum=0}return this._ticks%10===0&&(this._currentFPS=1e3/b),b>=this.MAX_FRAME_TIME&&(b=1e3/this.FPS),c={delta:b*this.TIME_FACTOR,tick:this._ticks,time:a,paused:this._paused},this.emit("ticker:tick",c),this._ticks+=1}},b}(d),b.exports=e}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../config/config":4,"./event":7}],13:[function(a,b){var c,d=[].slice;c=a("../config/config"),b.exports={log:function(){var a;return a=1<=arguments.length?d.call(arguments,0):[],c("debug")>=3?console.log.apply(console,a):void 0},warning:function(){var a;return a=1<=arguments.length?d.call(arguments,0):[],c("debug")>=2?console.warn.apply(console,a):void 0},error:function(){var a;return a=1<=arguments.length?d.call(arguments,0):[],c("debug")>=1?console.error.apply(console,a):void 0}}},{"../config/config":4}],14:[function(a,b){var c,d,e,f,g,h,i;a("./utils/polyfill"),i=a("./debug/debug"),h=a("./config/config"),c=a("./utils/const"),d=a("./core/engine"),f=a("./collection/doublylinkedlist"),g=a("./collection/orderedlinkedlist"),console.log.apply(console,["%c %c %c Entropy 0.2.0 - Entity System Framework for JavaScript %c %c ","background: rgb(200, 200,200);","background: rgb(80, 80, 80);","color: white; background: black;","background: rgb(80, 80, 80);","background: rgb(200, 200, 200);"]),e=function(){function b(){i.warning("this function should not be used as a constructor")}return b.Easing=a("./utils/easing"),b.Const=function(a,b){return c.call(this,a,b)},b.Config=h,b.Game=a("./core/game"),b.Engine=d,b.Ticker=a("./core/ticker"),b}(),b.exports=e},{"./collection/doublylinkedlist":1,"./collection/orderedlinkedlist":2,"./config/config":4,"./core/engine":5,"./core/game":8,"./core/ticker":12,"./debug/debug":13,"./utils/const":15,"./utils/easing":16,"./utils/polyfill":18}],15:[function(a,b){var c,d;d=a("./type"),c=a("../debug/debug"),b.exports=function(a,b){return null!=a&&d.of.string(a)?(a=a.toUpperCase(),a in this?c.error("cannot define same constans twice: %s",a):(Object.defineProperty(this,a,{value:b}),b)):void c.error("constans key should be non-empty string")}},{"../debug/debug":13,"./type":19}],16:[function(a,b){b.exports={Linear:{In:function(a,b,c,d){return c*a/d+b}},Quadratic:{In:function(a,b,c,d){return a/=d,c*a*a+b},Out:function(a,b,c,d){return a/=d,-c*a*(a-2)+b},InOut:function(a,b,c,d){return a/=d/2,1>a?c/2*a*a+b:(a--,-c/2*(a*(a-2)-1)+b)}},Cubic:{In:function(a,b,c,d){return a/=d,c*a*a*a+b},Out:function(a,b,c,d){return a/=d,a--,c*(a*a*a+1)+b},InOut:function(a,b,c,d){return a/=d/2,1>a?c/2*a*a*a+b:(a-=2,c/2*(a*a*a+2)+b)}},Quartic:{In:function(a,b,c,d){return a/=d,c*a*a*a*a+b},Out:function(a,b,c,d){return a/=d,a--,-c*(a*a*a*a-1)+b},InOut:function(a,b,c,d){return a/=d/2,1>a?c/2*a*a*a*a+b:(a-=2,-c/2*(a*a*a*a-2)+b)}},Quintic:{In:function(a,b,c,d){return a/=d,c*a*a*a*a*a+b},Out:function(a,b,c,d){return a/=d,a--,c*(a*a*a*a*a+1)+b},InOut:function(a,b,c,d){return a/=d/2,1>a?c/2*a*a*a*a*a+b:(a-=2,c/2*(a*a*a*a*a+2)+b)}},Sine:{In:function(a,b,c,d){return-c*Math.cos(a/d*(Math.PI/2))+c+b},Out:function(a,b,c,d){return c*Math.sin(a/d*(Math.PI/2))+b},InOut:function(a,b,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+b}},Exponential:{In:function(a,b,c,d){return c*Math.pow(2,10*(a/d-1))+b},Out:function(a,b,c,d){return c*(-Math.pow(2,-10*a/d)+1)+b},InOut:function(a,b,c,d){return a/=d/2,1>a?c/2*Math.pow(2,10*(a-1))+b:(a--,c/2*(-Math.pow(2,-10*a)+2)+b)}},Circular:{In:function(a,b,c,d){return a/=d,-c*(Math.sqrt(1-a*a)-1)+b},Out:function(a,b,c,d){return a/=d,a--,c*Math.sqrt(1-a*a)+b},InOut:function(a,b,c,d){return a/=d/2,1>a?-c/2*(Math.sqrt(1-a*a)-1)+b:(a-=2,c/2*(Math.sqrt(1-a*a)+1)+b)}}}},{}],17:[function(a,b){var c=[].slice,d={}.hasOwnProperty;b.exports=function(){var a,b,e,f,g,h,i;for(a=arguments[0],f=2<=arguments.length?c.call(arguments,1):[],h=0,i=f.length;i>h;h++){e=f[h];for(b in e)d.call(e,b)&&(g=e[b],a[b]=g)}return void 0}},{}],18:[function(){(function(a){!function(){var b,c,d,e,f;if(b=0,d=["ms","moz","webkit","o"],!a.requestAnimationFrame)for(e=0,f=d.length;f>e;e++)c=d[e],a.requestAnimationFrame=a[c+"RequestAnimationFrame"],a.cancelAnimationFrame=a[c+"CancelAnimationFrame"]||a[c+"CancelRequestAnimationFrame"];return a.requestAnimationFrame||(a.requestAnimationFrame=function(c){var d,e,f;return d=(new Date).getTime(),f=Math.max(0,16-(d-b)),e=a.setTimeout(function(){return c(d+f)},f),b=d+f,e}),void(a.cancelAnimationFrame||(a.cancelAnimationFrame=function(a){return clearTimeout(a)}))}(),function(){var b,c;return null==a.performance&&(a.performance={}),void(null==a.performance.now&&(b=Date.now(),null!=(null!=(c=a.performance.timing)?c.navigationStart:void 0)&&(b=performance.timing.navigationStart),a.performance.now=function(){return Date.now()-b
}))}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],19:[function(a,b){var c;c=Object.prototype.toString,b.exports={of:{undefined:function(a){return"[object Undefined]"===c.call(a)},"null":function(a){return"[object Null]"===c.call(a)},string:function(a){return"[object String]"===c.call(a)},number:function(a){return"[object Number]"===c.call(a)},"boolean":function(a){return"[object Boolean]"===c.call(a)},"function":function(a){return"[object Function]"===c.call(a)},array:function(a){return"[object Array]"===c.call(a)},date:function(a){return"[object Date]"===c.call(a)},regexp:function(a){return"[object RegExp]"===c.call(a)},object:function(a){return"[object Object]"===c.call(a)}}}},{}],20:[function(a,b){function c(a,b){void 0===a?a=31:"string"==typeof a&&(a=a.length),b=1!==b?0:2147483647;for(var d=31,e=Math.ceil(a/d),f=e;f--;)this[f]=b;if("string"==typeof a)for(f=a.length;f--;)this.set(f,a.charAt(f));var g=function(a,b,c,f){if(void 0===c&&(void 0===b?(b=0,c=e*d-1):c=b),0>b||b>c||c>=d*e)return null;for(var g=e;g--;){var h=Math.max(b,g*d),i=Math.min(c,d-1+d*g);if(i>=h){var j=~(1<<1+i%d)+(1<<h%d);0===f?a[g]&=j:a[g]^=~j}}return a};this.size=d*e,this.length=e,this.and=function(a){if(a instanceof c)for(var b=e;b--;)this[b]&=a[b]||0;return this},this.or=function(a){if(a instanceof c)for(var b=e;b--;)this[b]|=a[b]||0;return this},this.nand=function(a){if(a instanceof c)for(var b=e;b--;)this[b]=~(this[b]&(a[b]||0));return this},this.nor=function(a){if(a instanceof c)for(var b=e;b--;)this[b]=~(this[b]|(a[b]||0));return this},this.not=function(){for(var a=e;a--;)this[a]=~this[a];return this},this.xor=function(a){if(a instanceof c)for(var b=e;b--;)this[b]=this[b]^(a[b]||0);return this},this.equals=function(a){if(!(a instanceof c))return!1;if(a.length!==e)return!1;for(var b=e;b--;)if(a[b]!==this[b])return!1;return!0},this.subsetOf=function(a){if(!(a instanceof c))return!1;if(a.length!==e)return!1;for(var b=e;b--;)if((a[b]&this[b])!==this[b])return!1;return!0},this.clone=function(){for(var a=new c(this.size),b=e;b--;)a[b]=this[b];return a},this.isEmpty=function(){for(var a=e;a--;)if(0!==this[a])return!1;return!0},this.toString=function(a){for(var b="",c=e;c--;){e>c+1&&void 0!==a&&(b+=String(a));var f=this[c].toString(2);b+=new Array(1+d-f.length).join("0"),b+=f}return b},this.cardinality=function(){for(var a,b=0,c=e;c--;)for(a=this[c];a;a&=a-1,b++);return b},this.msb=function(){for(var a=e;a--;){var b=this[a],c=0;if(b){for(;b>>=1;c++);return d*a+c}}return 0},this.set=function(a,b){if(void 0===b&&(b=1),a>=0&&d*e>a){var c=a/d|0;return this[c]^=1<<a%d&(-(1&b)^this[c]),this}return null},this.setRange=function(a,b,c){if(b>=a&&a>=0&&d*e>b){if("string"==typeof c){if(b-a!==c.length)return null;for(var f=0;f<c.length;f++)this.set(f+a,c.charAt(c.length-f-1))}else{void 0===c&&(c=1);for(var f=a;b>=f;f++)this.set(f,c)}return this}return null},this.get=function(a){return a>=0&&d*e>a?this[a/d|0]>>a%d&1:null},this.getRange=function(a,b){if(b>=a&&a>=0&&d*e>b){for(var f=new c(b-a+1),g=a;b>=g;g++)f.set(g-a,this.get(g));return f}return null},this.clear=function(a,b){return g(this,a,b,0)},this.flip=function(a,b){return g(this,a,b,1)}}"undefined"!=typeof b&&b.exports&&(b.exports.BitSet=c)},{}],21:[function(b,c,d){!function(b,e){"function"==typeof a&&a.amd?a([],e):"object"==typeof d?c.exports=e():b.Inverse=e()}(this,function(){"use strict";var a=function(){this._boundCallbacks={},this._singletonCallbacks={},this._instantiatedSingletons={},this._registeredObjects={}};return a.prototype.make=function(a){if(this._registeredObjects.hasOwnProperty(a))return this._registeredObjects[a];var b=Array.prototype.slice.call(arguments,1);return this._singletonCallbacks.hasOwnProperty(a)?(this._instantiatedSingletons.hasOwnProperty(a)||(this._instantiatedSingletons[a]=this._singletonCallbacks[a].apply(this,b)),this._instantiatedSingletons[a]):this._boundCallbacks.hasOwnProperty(a)?this._boundCallbacks[a].apply(this,b):null},a.prototype.bind=function(a,b){this._boundCallbacks[a]=b},a.prototype.singleton=function(a,b){this._singletonCallbacks[a]=b},a.prototype.register=function(a,b){this._registeredObjects[a]=b},a})},{}]},{},[14])(14)});
//# sourceMappingURL=entropy.map.js